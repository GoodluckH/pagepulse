<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API Documentation - PagePulse</title>
  <meta name="description" content="PagePulse API documentation. Monitor websites for changes with our simple REST API.">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; color: #333; background: #f8fafc; }
    .container { max-width: 900px; margin: 0 auto; padding: 20px; }
    header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px 20px; margin-bottom: 30px; }
    header h1 { font-size: 2rem; margin-bottom: 10px; }
    header p { opacity: 0.9; }
    nav { background: white; padding: 15px 20px; border-radius: 8px; margin-bottom: 30px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    nav a { color: #667eea; text-decoration: none; margin-right: 20px; font-weight: 500; }
    nav a:hover { text-decoration: underline; }
    section { background: white; border-radius: 8px; padding: 30px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    h2 { color: #1a1a2e; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #667eea; }
    h3 { color: #333; margin: 25px 0 15px 0; }
    code { background: #f1f5f9; padding: 2px 6px; border-radius: 4px; font-family: 'Monaco', 'Consolas', monospace; font-size: 0.9em; }
    pre { background: #1a1a2e; color: #e2e8f0; padding: 20px; border-radius: 8px; overflow-x: auto; margin: 15px 0; }
    pre code { background: none; padding: 0; color: inherit; }
    .method { display: inline-block; padding: 4px 10px; border-radius: 4px; font-weight: bold; font-size: 0.8em; margin-right: 10px; }
    .get { background: #10b981; color: white; }
    .post { background: #3b82f6; color: white; }
    .delete { background: #ef4444; color: white; }
    .endpoint { font-family: monospace; font-size: 1.1em; color: #667eea; }
    table { width: 100%; border-collapse: collapse; margin: 15px 0; }
    th, td { padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0; }
    th { background: #f8fafc; font-weight: 600; }
    .param-required { color: #ef4444; font-size: 0.8em; }
    .param-optional { color: #6b7280; font-size: 0.8em; }
    .note { background: #fef3c7; border-left: 4px solid #f59e0b; padding: 15px; margin: 15px 0; border-radius: 0 8px 8px 0; }
    footer { text-align: center; padding: 30px; color: #6b7280; }
    footer a { color: #667eea; }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1>üì° PagePulse API</h1>
      <p>Monitor any website for changes. Simple REST API with webhook notifications.</p>
    </div>
  </header>

  <div class="container">
    <nav>
      <a href="/">‚Üê Home</a>
      <a href="#auth">Authentication</a>
      <a href="#monitors">Monitors</a>
      <a href="#webhooks">Webhooks</a>
      <a href="#examples">Examples</a>
    </nav>

    <section id="auth">
      <h2>Authentication</h2>
      <p>All API requests require an API key. Get one by creating a free account.</p>
      
      <h3><span class="method post">POST</span> <span class="endpoint">/api/register</span></h3>
      <p>Create a new account and get your API key.</p>
      <pre><code>curl -X POST https://successful-radiance-production.up.railway.app/api/register \
  -H "Content-Type: application/json" \
  -d '{"email": "you@example.com", "password": "securepass123"}'</code></pre>
      <p>Response:</p>
      <pre><code>{
  "success": true,
  "api_key": "pp_abc123...",
  "plan": "free"
}</code></pre>

      <h3><span class="method post">POST</span> <span class="endpoint">/api/login</span></h3>
      <p>Get your API key if you already have an account.</p>

      <div class="note">
        <strong>Using your API key:</strong> Include it in the <code>X-API-Key</code> header for all authenticated requests.
      </div>
    </section>

    <section id="monitors">
      <h2>Monitors</h2>

      <h3><span class="method get">GET</span> <span class="endpoint">/api/monitors</span></h3>
      <p>List all your monitors.</p>
      <pre><code>curl https://successful-radiance-production.up.railway.app/api/monitors \
  -H "X-API-Key: pp_your_api_key"</code></pre>

      <h3><span class="method post">POST</span> <span class="endpoint">/api/monitors</span></h3>
      <p>Create a new monitor.</p>
      <table>
        <tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
        <tr><td>name <span class="param-required">required</span></td><td>string</td><td>Friendly name for the monitor</td></tr>
        <tr><td>url <span class="param-required">required</span></td><td>string</td><td>URL to monitor</td></tr>
        <tr><td>selector <span class="param-optional">optional</span></td><td>string</td><td>CSS selector to watch specific element</td></tr>
        <tr><td>check_interval <span class="param-optional">optional</span></td><td>integer</td><td>Seconds between checks (min: 86400 for free)</td></tr>
        <tr><td>notify_webhook <span class="param-optional">optional</span></td><td>string</td><td>Webhook URL for notifications</td></tr>
        <tr><td>webhook_type <span class="param-optional">optional</span></td><td>string</td><td>"standard" or "slack"</td></tr>
        <tr><td>keywords <span class="param-optional">optional</span></td><td>array</td><td>Keywords to filter notifications</td></tr>
        <tr><td>keyword_mode <span class="param-optional">optional</span></td><td>string</td><td>"any", "all", "appear", "disappear"</td></tr>
      </table>
      <pre><code>curl -X POST https://successful-radiance-production.up.railway.app/api/monitors \
  -H "X-API-Key: pp_your_api_key" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Competitor Pricing",
    "url": "https://competitor.com/pricing",
    "selector": ".price-box",
    "notify_webhook": "https://hooks.slack.com/services/xxx",
    "webhook_type": "slack",
    "keywords": ["$99", "$199", "enterprise"],
    "keyword_mode": "any"
  }'</code></pre>

      <h3><span class="method get">GET</span> <span class="endpoint">/api/monitors/:id</span></h3>
      <p>Get details and recent checks for a specific monitor.</p>

      <h3><span class="method get">GET</span> <span class="endpoint">/api/monitors/:id/history</span></h3>
      <p>Get check history with visual diffs.</p>

      <h3><span class="method post">POST</span> <span class="endpoint">/api/monitors/:id/check</span></h3>
      <p>Trigger an immediate check (doesn't count against limits).</p>

      <h3><span class="method delete">DELETE</span> <span class="endpoint">/api/monitors/:id</span></h3>
      <p>Delete a monitor.</p>
    </section>

    <section id="webhooks">
      <h2>Webhook Payloads</h2>
      
      <h3>Standard Webhook</h3>
      <pre><code>{
  "event": "change_detected",
  "monitor": {
    "id": "abc-123",
    "name": "Competitor Pricing",
    "url": "https://competitor.com/pricing"
  },
  "diff": {
    "summary": "2 lines added, 1 line removed",
    "added": ["New price: $149/mo"],
    "removed": ["Old price: $99/mo"]
  },
  "checked_at": "2025-02-05T10:00:00Z"
}</code></pre>

      <h3>Slack Webhook</h3>
      <p>Use <code>webhook_type: "slack"</code> for formatted Slack messages with the diff displayed nicely.</p>
    </section>

    <section id="examples">
      <h2>Examples</h2>

      <h3>Monitor a job board for new postings</h3>
      <pre><code>curl -X POST https://successful-radiance-production.up.railway.app/api/monitors \
  -H "X-API-Key: pp_your_api_key" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "YC Jobs - AI",
    "url": "https://www.ycombinator.com/jobs",
    "keywords": ["AI", "Machine Learning", "GPT"],
    "keyword_mode": "any"
  }'</code></pre>

      <h3>Track price drops</h3>
      <pre><code>curl -X POST https://successful-radiance-production.up.railway.app/api/monitors \
  -H "X-API-Key: pp_your_api_key" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Product Price Watch",
    "url": "https://store.com/product",
    "selector": ".product-price",
    "notify_webhook": "https://discord.com/api/webhooks/xxx"
  }'</code></pre>

      <h3>Python example</h3>
      <pre><code>import requests

API_KEY = "pp_your_api_key"
BASE = "https://successful-radiance-production.up.railway.app/api"

# Create monitor
resp = requests.post(f"{BASE}/monitors", 
    headers={"X-API-Key": API_KEY},
    json={"name": "My Monitor", "url": "https://example.com"})
print(resp.json())

# List monitors
monitors = requests.get(f"{BASE}/monitors",
    headers={"X-API-Key": API_KEY}).json()
print(monitors)</code></pre>
    </section>

    <footer>
      <p>Built by <a href="https://github.com/GoodluckH/pagepulse">an AI agent</a> ü§ñ</p>
      <p><a href="/">Back to PagePulse</a></p>
    </footer>
  </div>
</body>
</html>
